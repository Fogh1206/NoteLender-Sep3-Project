@page "/"

@inject IGroupService _groupService
@inject IInvitationService _invitationService
@inject INoteService _noteService
@inject NavigationManager NavigationManager;
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NotificationManager NotificationManager
@using Sep3Blazor.Component
@using LoginComponent
@using Sep3Blazor.Data.GroupData
@using Sep3Blazor.Data.NoteData
@using Sep3Blazor.Data.Notifications
@using Sep3Blazor.Data.Notifications.NotificationModel
@using System.Globalization
@using Microsoft.AspNetCore.Components.Web.Extensions.Head
@using Sep3Blazor.Data.InvitationData


<Title Value="Homepage"/>

<Login/>
<AuthorizeView >
    <div class="row d-flex justify-content-between">
        <div class="col-sm-5">
            <GroupListing Value=@context.User.FindFirst("id").Value></GroupListing>
        </div>
        <div class="col-sm-5">
            <Invitations Value=@context.User.FindFirst("id").Value></Invitations>
        </div>
    </div>
    <br/>
    <div class="row">
        <div class="col-sm-12">
            <p>
                Penguins are a group of aquatic flightless birds. They live almost exclusively in the southern hemisphere: only one species, the Galápagos penguin, is found north of the Equator.
                Highly adapted for life in the water, penguins have countershaded dark and white plumage and flippers for swimming.
                Most penguins feed on krill, fish, squid and other forms of sea life which they catch while swimming underwater.
                They spend roughly half of their lives on land and the other half in the sea.
                <br>
                Although almost all penguin species are native to the southern hemisphere, they are not found only in areas with cold climates, such as Antarctica.
                In fact, only a few species of penguin live that far south. Several species are found in the temperate zone, and one species, the Galápagos penguin, lives near the Equator.
                <br>
                The largest living species is the emperor penguin on average, adults are about 1.1 m (3 ft 7 in) tall and weigh 35 kg (77 lb).
                The smallest penguin species is the little blue penguin (Eudyptula minor), also known as the fairy penguin, which stands around 33 cm (13 in) tall and weighs 1 kg (2.2 lb).
                In general today, larger penguins inhabit colder regions, and smaller penguins inhabit regions with temperate or tropical climates.
                Some prehistoric penguin species were enormous: as tall or heavy as an adult human.
                There was a great diversity of species in subantarctic regions, and at least one giant species in a region around 2,000 km south of the equator 35 mya, in a climate decidedly warmer than today.
            </p>
        </div>
    </div>
</AuthorizeView>
<div class="main-title-big" @onclick="ShowNotification">
    Welcome
</div>


@code
{
    protected override async Task OnInitializedAsync()
    {
        base.OnInitialized();


        Console.WriteLine(GetIso8601WeekOfYear(DateTime.Today));
    }

    private async void ShowNotification()
    {
        await NotificationManager.Show("Title", "a simple paragraph", NotificationType.Info);
    }

    public static int GetIso8601WeekOfYear(DateTime time)
    {
        DayOfWeek day = CultureInfo.InvariantCulture.Calendar.GetDayOfWeek(time);
        if (day >= DayOfWeek.Monday && day <= DayOfWeek.Wednesday)
        {
            time = time.AddDays(3);
        }
        return CultureInfo.InvariantCulture.Calendar.GetWeekOfYear(time, CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Monday);
    }
}