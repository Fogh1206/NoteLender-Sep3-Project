@using Microsoft.AspNetCore.Components
@using Sep3Blazor.Data.NoteData
@using Sep3Blazor.Model
@inject INoteService _noteService

@if (_id == null)
{
}
else
{
    <tbody>
    <tr>
        <th scope="row">Name</th>
        <td>@noteToAdd.name</td>
    </tr>
    <tr>
        <th scope="row">Year</th>
        <td>@noteToAdd.year</td>
    </tr>
    <tr>
        <th scope="row">Status</th>
        <td>@noteToAdd.status</td>
    </tr>
    <tr>
        <th scope="row">Text</th>
        <td class="table-warning">@noteToAdd.text</td>
    </tr>
    </tbody>
    <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="@("#exampleEditModal"+_id)">Edit</button>
    <div class="modal fade" id="@("exampleEditModal"+_id)" tabindex="-1" aria-labelledby="@("exampleEditModalLabel"+_id)" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="background-color:white">
                <div class="modal-header">
                    <h5 class="modal-title" id="@("exampleEditModalLabel"+_id)">Node @noteToAdd.id in Group @noteToAdd.groupId</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancel"></button>
                </div>
                <div class="modal-body">
                    <EditForm Model="@noteToAddModel" OnValidSubmit="@SubmitEditNote">
                        <DataAnnotationsValidator/>
                        <ValidationSummary/>
                        <p>
                            <label>
                                Week:
                                <InputNumber @bind-Value="noteToAdd.week"/>
                            </label>
                        </p>
                        <p>
                            <label>
                                Year:
                                <InputNumber @bind-Value="noteToAdd.year"/>
                            </label>
                        </p>
                        <p>
                            <label>
                                Name:
                                <InputText @bind-Value="noteToAdd.name"/>
                            </label>
                        </p>
                        <p>
                            <label>
                                Status:
                                <InputSelect @bind-Value="noteToAdd.status">
                                    <option value="">Not started</option>
                                    <option value="Started">Started</option>
                                    <option value="Finished">Finished</option>
                                </InputSelect>
                            </label>
                        </p>
                        <p>
                            <label>
                                Text
                                <InputTextArea @bind-Value="noteToAdd.text"/>
                            </label>
                        </p>
                        <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">Save changes</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    </EditForm>
                </div>
            </div>
        </div>
    </div>
    <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="@("#exampleDelete"+_id)">
        Delete
    </button>
    <div class="modal fade" id="@("exampleDelete"+_id)" tabindex="-1" role="dialog" aria-labelledby="@("exampleModalCenterTitle"+_id)" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content" style="background-color: white">
                <div class="modal-header">
                    <h5 class="modal-title" id="@("exampleModalLongTitle"+_id)">Delete Note#@noteToAdd.id from group#@noteToAdd.groupId?</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cancel"></button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" @onclick="@(DeleteNote)">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <br>
}

@code {

    [Parameter]
    public Note Note { get; set; }

    [Parameter]
    public int Id { get; set; }

    private Note noteToAdd;

    private Note noteToAddModel = new Note(0, 0, 0, 0, 0, "", "", "");

    private int _id;

    private void SubmitEditNote()
    {
        Console.WriteLine("G:  W: " + Note.week + " Y: " + Note.year + " N: " + Note.name + " S: " + Note.status + " T: " + Note.text);
    }


    protected override void OnInitialized()
    {
        _id = Id;
        noteToAdd = Note;
        Console.WriteLine("ID " + _id + " Note " + noteToAdd.name);
    }


    private async Task DeleteNote()
    {
    // await _noteService.DeleteNote(Note.id);
        Console.WriteLine("Deleted " + noteToAdd.id);
        Console.WriteLine("Deleted " + noteToAdd.name);
    }
    
}